2024-05-12 20:08:09.603 INFO: Using gradient clipping with tolerance=10.000
2024-05-12 20:08:09.604 INFO: Started training
2024-05-12 20:08:18.739 INFO: Epoch None: loss=1.8340, RMSE_E_per_atom=42.8 meV, RMSE_F=0.9 meV / A
2024-05-12 20:08:52.469 INFO: Epoch 0: loss=1.7264, RMSE_E_per_atom=41.5 meV, RMSE_F=38.9 meV / A
2024-05-12 20:09:14.901 INFO: Epoch 1: loss=1.6196, RMSE_E_per_atom=40.2 meV, RMSE_F=96.1 meV / A
2024-05-12 20:09:37.167 INFO: Epoch 2: loss=1.4009, RMSE_E_per_atom=37.4 meV, RMSE_F=133.0 meV / A
2024-05-12 20:09:59.514 INFO: Epoch 3: loss=1.2519, RMSE_E_per_atom=35.3 meV, RMSE_F=199.7 meV / A
2024-05-12 20:10:21.894 INFO: Epoch 4: loss=1.1366, RMSE_E_per_atom=33.7 meV, RMSE_F=221.7 meV / A
2024-05-12 20:10:44.038 INFO: Epoch 5: loss=1.0379, RMSE_E_per_atom=32.2 meV, RMSE_F=224.2 meV / A
2024-05-12 20:11:06.254 INFO: Epoch 6: loss=0.9774, RMSE_E_per_atom=31.2 meV, RMSE_F=236.2 meV / A
2024-05-12 20:11:28.515 INFO: Epoch 7: loss=0.9221, RMSE_E_per_atom=30.3 meV, RMSE_F=244.7 meV / A
2024-05-12 20:11:50.957 INFO: Epoch 8: loss=0.8947, RMSE_E_per_atom=29.9 meV, RMSE_F=235.3 meV / A
2024-05-12 20:12:12.969 INFO: Epoch 9: loss=0.8749, RMSE_E_per_atom=29.5 meV, RMSE_F=242.9 meV / A
2024-05-12 20:12:35.189 INFO: Epoch 10: loss=0.8596, RMSE_E_per_atom=29.3 meV, RMSE_F=252.9 meV / A
2024-05-12 20:12:57.694 INFO: Epoch 11: loss=0.8321, RMSE_E_per_atom=28.8 meV, RMSE_F=257.6 meV / A
2024-05-12 20:13:19.886 INFO: Epoch 12: loss=0.8182, RMSE_E_per_atom=28.6 meV, RMSE_F=258.1 meV / A
2024-05-12 20:13:42.071 INFO: Epoch 13: loss=0.8013, RMSE_E_per_atom=28.3 meV, RMSE_F=265.0 meV / A
2024-05-12 20:14:04.326 INFO: Epoch 14: loss=0.7987, RMSE_E_per_atom=28.2 meV, RMSE_F=266.8 meV / A
2024-05-12 20:14:26.697 INFO: Epoch 15: loss=0.7907, RMSE_E_per_atom=28.1 meV, RMSE_F=269.9 meV / A
2024-05-12 20:14:48.902 INFO: Epoch 16: loss=0.7770, RMSE_E_per_atom=27.8 meV, RMSE_F=272.9 meV / A
2024-05-12 20:15:11.140 INFO: Epoch 17: loss=0.7839, RMSE_E_per_atom=28.0 meV, RMSE_F=271.4 meV / A
2024-05-12 20:15:33.258 INFO: Epoch 18: loss=0.7727, RMSE_E_per_atom=27.8 meV, RMSE_F=288.5 meV / A
2024-05-12 20:15:55.607 INFO: Epoch 19: loss=0.7673, RMSE_E_per_atom=27.7 meV, RMSE_F=299.9 meV / A
2024-05-12 20:16:17.912 INFO: Epoch 20: loss=0.7629, RMSE_E_per_atom=27.6 meV, RMSE_F=301.1 meV / A
2024-05-12 20:16:39.993 INFO: Epoch 21: loss=0.7571, RMSE_E_per_atom=27.5 meV, RMSE_F=318.5 meV / A
2024-05-12 20:17:01.949 INFO: Epoch 22: loss=0.7573, RMSE_E_per_atom=27.5 meV, RMSE_F=327.2 meV / A
2024-05-12 20:17:24.006 INFO: Epoch 23: loss=0.7642, RMSE_E_per_atom=27.6 meV, RMSE_F=340.6 meV / A
2024-05-12 20:17:45.961 INFO: Epoch 24: loss=0.7646, RMSE_E_per_atom=27.6 meV, RMSE_F=360.9 meV / A
2024-05-12 20:18:07.996 INFO: Epoch 25: loss=0.7528, RMSE_E_per_atom=27.4 meV, RMSE_F=375.9 meV / A
2024-05-12 20:18:30.069 INFO: Epoch 26: loss=0.7562, RMSE_E_per_atom=27.5 meV, RMSE_F=392.2 meV / A
2024-05-12 20:18:52.060 INFO: Epoch 27: loss=0.7465, RMSE_E_per_atom=27.3 meV, RMSE_F=399.3 meV / A
2024-05-12 20:19:14.301 INFO: Epoch 28: loss=0.7448, RMSE_E_per_atom=27.3 meV, RMSE_F=424.9 meV / A
2024-05-12 20:19:36.547 INFO: Epoch 29: loss=0.7333, RMSE_E_per_atom=27.0 meV, RMSE_F=430.6 meV / A
2024-05-12 20:19:58.734 INFO: Epoch 30: loss=0.7351, RMSE_E_per_atom=27.1 meV, RMSE_F=455.5 meV / A
2024-05-12 20:20:20.963 INFO: Epoch 31: loss=0.7409, RMSE_E_per_atom=27.2 meV, RMSE_F=456.8 meV / A
2024-05-12 20:20:43.138 INFO: Epoch 32: loss=0.7400, RMSE_E_per_atom=27.2 meV, RMSE_F=473.2 meV / A
2024-05-12 20:21:05.454 INFO: Epoch 33: loss=0.7352, RMSE_E_per_atom=27.1 meV, RMSE_F=482.8 meV / A
2024-05-12 20:21:27.651 INFO: Epoch 34: loss=0.7317, RMSE_E_per_atom=27.0 meV, RMSE_F=495.4 meV / A
2024-05-12 20:21:49.840 INFO: Epoch 35: loss=0.7351, RMSE_E_per_atom=27.1 meV, RMSE_F=515.7 meV / A
2024-05-12 20:22:11.937 INFO: Epoch 36: loss=0.7290, RMSE_E_per_atom=27.0 meV, RMSE_F=514.6 meV / A
2024-05-12 20:22:34.044 INFO: Epoch 37: loss=0.7560, RMSE_E_per_atom=27.5 meV, RMSE_F=537.3 meV / A
2024-05-12 20:22:56.140 INFO: Epoch 38: loss=0.7527, RMSE_E_per_atom=27.4 meV, RMSE_F=540.3 meV / A
2024-05-12 20:23:18.307 INFO: Epoch 39: loss=0.7402, RMSE_E_per_atom=27.2 meV, RMSE_F=519.2 meV / A
2024-05-12 20:23:40.543 INFO: Epoch 40: loss=0.7465, RMSE_E_per_atom=27.3 meV, RMSE_F=523.6 meV / A
2024-05-12 20:24:02.648 INFO: Epoch 41: loss=0.7557, RMSE_E_per_atom=27.5 meV, RMSE_F=537.2 meV / A
2024-05-12 20:24:24.753 INFO: Epoch 42: loss=0.7533, RMSE_E_per_atom=27.4 meV, RMSE_F=542.5 meV / A
2024-05-12 20:24:46.820 INFO: Epoch 43: loss=0.7620, RMSE_E_per_atom=27.6 meV, RMSE_F=542.9 meV / A
2024-05-12 20:25:09.088 INFO: Epoch 44: loss=0.7799, RMSE_E_per_atom=27.9 meV, RMSE_F=550.9 meV / A
2024-05-12 20:25:31.166 INFO: Epoch 45: loss=0.7710, RMSE_E_per_atom=27.7 meV, RMSE_F=556.8 meV / A
2024-05-12 20:25:53.403 INFO: Epoch 46: loss=0.7946, RMSE_E_per_atom=28.2 meV, RMSE_F=556.0 meV / A
2024-05-12 20:26:15.480 INFO: Epoch 47: loss=0.7817, RMSE_E_per_atom=27.9 meV, RMSE_F=547.2 meV / A
2024-05-12 20:26:37.715 INFO: Epoch 48: loss=0.7658, RMSE_E_per_atom=27.6 meV, RMSE_F=549.2 meV / A
2024-05-12 20:27:00.294 INFO: Epoch 49: loss=0.7790, RMSE_E_per_atom=27.9 meV, RMSE_F=564.1 meV / A
2024-05-12 20:27:22.581 INFO: Epoch 50: loss=0.7707, RMSE_E_per_atom=27.7 meV, RMSE_F=557.7 meV / A
2024-05-12 20:27:44.746 INFO: Epoch 51: loss=0.7747, RMSE_E_per_atom=27.8 meV, RMSE_F=565.5 meV / A
2024-05-12 20:28:07.075 INFO: Epoch 52: loss=0.7713, RMSE_E_per_atom=27.7 meV, RMSE_F=564.1 meV / A
2024-05-12 20:28:29.399 INFO: Epoch 53: loss=0.7801, RMSE_E_per_atom=27.9 meV, RMSE_F=579.9 meV / A
2024-05-12 20:28:51.796 INFO: Epoch 54: loss=0.7726, RMSE_E_per_atom=27.8 meV, RMSE_F=576.3 meV / A
2024-05-12 20:29:14.012 INFO: Epoch 55: loss=0.7853, RMSE_E_per_atom=28.0 meV, RMSE_F=574.7 meV / A
2024-05-12 20:29:36.219 INFO: Epoch 56: loss=0.7723, RMSE_E_per_atom=27.8 meV, RMSE_F=586.4 meV / A
2024-05-12 20:29:58.435 INFO: Epoch 57: loss=0.7832, RMSE_E_per_atom=28.0 meV, RMSE_F=580.6 meV / A
2024-05-12 20:30:20.477 INFO: Epoch 58: loss=0.7936, RMSE_E_per_atom=28.1 meV, RMSE_F=593.2 meV / A
2024-05-12 20:30:42.567 INFO: Epoch 59: loss=0.7924, RMSE_E_per_atom=28.1 meV, RMSE_F=594.4 meV / A
2024-05-12 20:31:04.662 INFO: Epoch 60: loss=0.7816, RMSE_E_per_atom=27.9 meV, RMSE_F=593.3 meV / A
2024-05-12 20:31:26.843 INFO: Epoch 61: loss=0.7795, RMSE_E_per_atom=27.9 meV, RMSE_F=596.0 meV / A
2024-05-12 20:31:49.024 INFO: Epoch 62: loss=0.7876, RMSE_E_per_atom=28.0 meV, RMSE_F=598.4 meV / A
2024-05-12 20:32:11.146 INFO: Epoch 63: loss=0.7819, RMSE_E_per_atom=27.9 meV, RMSE_F=605.9 meV / A
2024-05-12 20:32:33.457 INFO: Epoch 64: loss=0.7935, RMSE_E_per_atom=28.1 meV, RMSE_F=616.9 meV / A
2024-05-12 20:32:55.591 INFO: Epoch 65: loss=0.7955, RMSE_E_per_atom=28.2 meV, RMSE_F=612.7 meV / A
2024-05-12 20:33:17.713 INFO: Epoch 66: loss=0.8088, RMSE_E_per_atom=28.4 meV, RMSE_F=620.4 meV / A
2024-05-12 20:33:17.714 INFO: Stopping optimization after 30 epochs without improvement and starting swa
2024-05-12 20:33:17.714 INFO: Changing loss based on SWA
2024-05-12 20:33:39.977 INFO: Epoch 751: loss=0.0787, RMSE_E_per_atom=28.0 meV, RMSE_F=616.5 meV / A
2024-05-12 20:34:02.254 INFO: Epoch 752: loss=0.0793, RMSE_E_per_atom=28.1 meV, RMSE_F=628.2 meV / A
2024-05-12 20:34:24.371 INFO: Epoch 753: loss=0.0801, RMSE_E_per_atom=28.3 meV, RMSE_F=635.0 meV / A
2024-05-12 20:34:46.585 INFO: Epoch 754: loss=0.0800, RMSE_E_per_atom=28.3 meV, RMSE_F=638.4 meV / A
2024-05-12 20:35:08.978 INFO: Epoch 755: loss=0.0800, RMSE_E_per_atom=28.3 meV, RMSE_F=640.9 meV / A
2024-05-12 20:35:31.227 INFO: Epoch 756: loss=0.0802, RMSE_E_per_atom=28.3 meV, RMSE_F=644.5 meV / A
2024-05-12 20:35:53.290 INFO: Epoch 757: loss=0.0799, RMSE_E_per_atom=28.2 meV, RMSE_F=643.1 meV / A
2024-05-12 20:36:15.277 INFO: Epoch 758: loss=0.0800, RMSE_E_per_atom=28.3 meV, RMSE_F=646.2 meV / A
2024-05-12 20:36:37.419 INFO: Epoch 759: loss=0.0799, RMSE_E_per_atom=28.2 meV, RMSE_F=648.2 meV / A
2024-05-12 20:36:59.700 INFO: Epoch 760: loss=0.0803, RMSE_E_per_atom=28.3 meV, RMSE_F=650.3 meV / A
2024-05-12 20:37:22.107 INFO: Epoch 761: loss=0.0800, RMSE_E_per_atom=28.2 meV, RMSE_F=648.9 meV / A
2024-05-12 20:37:44.146 INFO: Epoch 762: loss=0.0801, RMSE_E_per_atom=28.3 meV, RMSE_F=652.0 meV / A
2024-05-12 20:38:06.068 INFO: Epoch 763: loss=0.0801, RMSE_E_per_atom=28.3 meV, RMSE_F=653.3 meV / A
2024-05-12 20:38:28.178 INFO: Epoch 764: loss=0.0804, RMSE_E_per_atom=28.3 meV, RMSE_F=654.7 meV / A
2024-05-12 20:38:50.326 INFO: Epoch 765: loss=0.0800, RMSE_E_per_atom=28.3 meV, RMSE_F=655.5 meV / A
2024-05-12 20:39:12.402 INFO: Epoch 766: loss=0.0802, RMSE_E_per_atom=28.3 meV, RMSE_F=657.3 meV / A
2024-05-12 20:39:34.470 INFO: Epoch 767: loss=0.0802, RMSE_E_per_atom=28.3 meV, RMSE_F=657.3 meV / A
2024-05-12 20:39:56.651 INFO: Epoch 768: loss=0.0799, RMSE_E_per_atom=28.2 meV, RMSE_F=657.9 meV / A
2024-05-12 20:40:18.783 INFO: Epoch 769: loss=0.0801, RMSE_E_per_atom=28.3 meV, RMSE_F=660.9 meV / A
2024-05-12 20:40:40.905 INFO: Epoch 770: loss=0.0805, RMSE_E_per_atom=28.3 meV, RMSE_F=661.2 meV / A
2024-05-12 20:41:03.110 INFO: Epoch 771: loss=0.0804, RMSE_E_per_atom=28.3 meV, RMSE_F=660.9 meV / A
2024-05-12 20:41:25.136 INFO: Epoch 772: loss=0.0804, RMSE_E_per_atom=28.3 meV, RMSE_F=662.4 meV / A
2024-05-12 20:41:47.209 INFO: Epoch 773: loss=0.0807, RMSE_E_per_atom=28.4 meV, RMSE_F=663.7 meV / A
2024-05-12 20:42:09.294 INFO: Epoch 774: loss=0.0801, RMSE_E_per_atom=28.3 meV, RMSE_F=664.1 meV / A
2024-05-12 20:42:31.522 INFO: Epoch 775: loss=0.0807, RMSE_E_per_atom=28.4 meV, RMSE_F=667.9 meV / A
2024-05-12 20:42:53.552 INFO: Epoch 776: loss=0.0811, RMSE_E_per_atom=28.5 meV, RMSE_F=667.9 meV / A
2024-05-12 20:43:15.892 INFO: Epoch 777: loss=0.0808, RMSE_E_per_atom=28.4 meV, RMSE_F=667.9 meV / A
2024-05-12 20:43:38.124 INFO: Epoch 778: loss=0.0808, RMSE_E_per_atom=28.4 meV, RMSE_F=668.7 meV / A
2024-05-12 20:44:00.386 INFO: Epoch 779: loss=0.0806, RMSE_E_per_atom=28.4 meV, RMSE_F=672.3 meV / A
2024-05-12 20:44:22.546 INFO: Epoch 780: loss=0.0810, RMSE_E_per_atom=28.4 meV, RMSE_F=672.2 meV / A
2024-05-12 20:44:44.740 INFO: Epoch 781: loss=0.0808, RMSE_E_per_atom=28.4 meV, RMSE_F=671.9 meV / A
2024-05-12 20:44:44.741 INFO: Stopping optimization after 30 epochs without improvement
2024-05-12 20:44:44.741 INFO: Training complete
2024-05-12 20:44:44.741 INFO: Computing metrics for training, validation, and test sets
2024-05-12 20:44:45.048 INFO: Loading checkpoint: checkpoints/MACE_THz_orig_run-42_epoch-36.pt
2024-05-12 20:44:45.098 INFO: Loaded model from epoch 36
2024-05-12 20:44:45.099 INFO: Evaluating train ...
2024-05-12 20:44:53.537 INFO: Evaluating valid ...
2024-05-12 20:44:54.853 INFO: Evaluating Default ...
2024-05-12 20:44:57.466 INFO:
+-------------+---------------------+------------------+-------------------+
| config_type | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+-------------+---------------------+------------------+-------------------+
|    train    |         17.9        |      526.6       |   52658045291.90  |
|    valid    |         27.0        |      514.6       |   51463699340.82  |
|   Default   |         27.6        |      518.6       |   51862013340.00  |
+-------------+---------------------+------------------+-------------------+
2024-05-12 20:44:57.466 INFO: Saving model to checkpoints/MACE_THz_orig_run-42.model
2024-05-12 20:44:57.589 INFO: Compiling model, saving metadata to MACE_THz_orig_compiled.model
/home/chem/mstvtc/maceenv/lib/python3.9/site-packages/torch/jit/_check.py:177: UserWarning: The TorchScript type system doesn't support instance-level annotations on empty non-base types in `__init__`. Instead, either 1) use a type annotation in the class body, or 2) wrap the type in `torch.jit.Attribute`.
  warnings.warn(
2024-05-12 20:44:58.486 INFO: Loading checkpoint: checkpoints/MACE_THz_orig_run-42_epoch-751_swa.pt
2024-05-12 20:44:58.543 INFO: Loaded model from epoch 751
2024-05-12 20:44:58.544 INFO: Evaluating train ...
2024-05-12 20:45:06.835 INFO: Evaluating valid ...
2024-05-12 20:45:08.127 INFO: Evaluating Default ...
2024-05-12 20:45:10.689 INFO:
+-------------+---------------------+------------------+-------------------+
| config_type | RMSE E / meV / atom | RMSE F / meV / A | relative F RMSE % |
+-------------+---------------------+------------------+-------------------+
|    train    |         10.6        |      618.5       |   61847519874.57  |
|    valid    |         28.0        |      616.5       |   61650562286.38  |
|   Default   |         28.9        |      610.5       |   61054837703.70  |
+-------------+---------------------+------------------+-------------------+
2024-05-12 20:45:10.689 INFO: Saving model to checkpoints/MACE_THz_orig_run-42_swa.model
2024-05-12 20:45:10.809 INFO: Compiling model, saving metadata MACE_THz_orig_swa_compiled.model
2024-05-12 20:45:11.651 INFO: Done